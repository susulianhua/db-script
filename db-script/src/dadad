/*-------start-----*/
DROP SEQUENCE SEQ_T_CUSTOM;
CREATE TABLE t_custom (
	id  NUMBER,
	name  VARCHAR2(150),
	CONSTRAINT pk_t_custom PRIMARY KEY (id)
);
CREATE SEQUENCE SEQ_T_CUSTOM;
CREATE OR REPLACE TRIGGER TRI_T_CUSTOM BEFORE INSERT ON T_CUSTOM FOR EACH ROW WHEN (NEW.ID IS NULL) BEGIN SELECT SEQ_T_CUSTOM.NEXTVAL INTO :NEW.ID FROM DUAL; END;
/
DROP SEQUENCE SEQ_T_ORG;
CREATE TABLE t_org (
	o_id  NUMBER,
	name  VARCHAR2(150),
	p_id  NUMBER,
	CONSTRAINT pk_t_org PRIMARY KEY (o_id)
);
CREATE SEQUENCE SEQ_T_ORG;
CREATE OR REPLACE TRIGGER TRI_T_ORG BEFORE INSERT ON T_ORG FOR EACH ROW WHEN (NEW.O_ID IS NULL) BEGIN SELECT SEQ_T_ORG.NEXTVAL INTO :NEW.O_ID FROM DUAL; END;
/
ALTER TABLE t_org ADD CONSTRAINT fk_org_parent FOREIGN KEY (p_id) REFERENCES t_org(o_id);
CREATE UNIQUE INDEX a ON t_org ( o_id asc,name asc,p_id asc ) ;
CREATE UNIQUE INDEX b ON t_org ( o_id asc,name asc ) ;
CREATE TABLE t_user (
	v_id  VARCHAR2(150),
	name  VARCHAR2(150),
	teacher  VARCHAR2(150),
	age  NUMBER,
	parent_id  VARCHAR2(150),
	o_id  NUMBER,
	sort  NUMBER,
	CONSTRAINT pk_t_user PRIMARY KEY (v_id)
);
ALTER TABLE t_user ADD CONSTRAINT fk_user_parent FOREIGN KEY (parent_id) REFERENCES t_user(v_id);
ALTER TABLE t_user ADD CONSTRAINT fk_user_org FOREIGN KEY (o_id) REFERENCES t_org(o_id);
CREATE UNIQUE INDEX dsad ON t_user (  ) ;
CREATE UNIQUE INDEX IDX_T_USER_NAME ON t_user ( name ) ;
CREATE UNIQUE INDEX IDX_T_USER_AGE ON t_user ( age ) ;
CREATE UNIQUE INDEX IDX_T_USER_SORT ON t_user ( sort ) ;
DROP SEQUENCE SEQ_INCREMENTER;
CREATE TABLE incrementer (
	sequence_id  NUMBER,
	dummy  VARCHAR2(3),
	CONSTRAINT pk_incrementer PRIMARY KEY (sequence_id)
);
CREATE SEQUENCE SEQ_INCREMENTER;
CREATE OR REPLACE TRIGGER TRI_INCREMENTER BEFORE INSERT ON INCREMENTER FOR EACH ROW WHEN (NEW.SEQUENCE_ID IS NULL) BEGIN SELECT SEQ_INCREMENTER.NEXTVAL INTO :NEW.SEQUENCE_ID FROM DUAL; END;
/
CREATE SEQUENCE ddd INCREMENT BY 1 START WITH 0 MINVALUE 10 MAXVALUE 20 NOCYCLE  CACHE 20 NOORDER ;;
CREATE OR REPLACE VIEW org_view AS SELECT * FROM T_ORG;
CREATE OR REPLACE VIEW user_view AS SELECT * FROM t_user;
CREATE OR REPLACE VIEW role_user_view AS SELECT o.o_id,o.name,u.name username,u.v_id FROM org_view o, user_view u WHERE o.o_id = u.o_id;
CREATE OR REPLACE PROCEDURE y_p_test AS BEGIN
/
CREATE OR REPLACE trigger user_view AS SELECT * FROM t_user;;
/*-------end-----*/
